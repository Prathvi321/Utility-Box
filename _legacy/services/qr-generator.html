<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Generator</title>
    <!-- Tailwind CSS CDN for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }
        .container-card {
            background-color: #ffffff;
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            max-width: 40rem;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        #qrcode-container img, #qrcode-container canvas {
            border-radius: 0.75rem;
        }
        .qr-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 1rem;
        }
        .qr-item p {
            margin-top: 0.5rem;
            font-size: 0.875rem;
            color: #4b5563;
            max-width: 15rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .input-group {
            display: flex;
            align-items: center;
            width: 100%;
            margin-bottom: 0.5rem;
        }
        .input-group input {
            flex-grow: 1;
        }
    </style>
</head>
<body>

    <!-- Main container for the QR code generator interface -->
    <div class="container-card">
        <h1 class="text-3xl sm:text-4xl font-bold text-gray-800 mb-4">QR Code Generator</h1>
        <p class="text-gray-500 mb-6">Choose your mode and get your QR codes instantly.</p>
        
        <!-- Mode selection buttons -->
        <div class="flex space-x-4 mb-8">
            <button id="single-mode-btn" class="px-6 py-3 bg-indigo-600 text-white font-semibold rounded-xl hover:bg-indigo-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                Single URL
            </button>
            <button id="multi-mode-btn" class="px-6 py-3 bg-gray-200 text-gray-700 font-semibold rounded-xl hover:bg-gray-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2">
                Multiple URLs
            </button>
        </div>

        <!-- Single URL Input Section -->
        <div id="single-url-section" class="w-full flex flex-col items-center">
            <input type="url" id="url-input" placeholder="e.g., https://www.google.com"
                   class="flex-grow w-full p-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-indigo-500 transition-colors duration-200 mb-4">
            <button id="generate-btn"
                    class="w-full px-6 py-3 bg-indigo-600 text-white font-semibold rounded-xl hover:bg-indigo-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                Generate QR
            </button>
        </div>

        <!-- Multiple URL Input Section -->
        <div id="multi-url-section" class="w-full flex-col items-center hidden">
            <div id="multi-url-inputs-container" class="w-full mb-4">
                <!-- URL input fields will be dynamically added here -->
            </div>
            <button id="add-url-btn" class="w-full px-6 py-3 bg-gray-400 text-white font-semibold rounded-xl hover:bg-gray-500 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 mb-4">
                Add URL
            </button>
            <button id="generate-multi-btn"
                    class="w-full px-6 py-3 bg-indigo-600 text-white font-semibold rounded-xl hover:bg-indigo-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                Generate All QR Codes
            </button>
        </div>

        <!-- QR code containers and download buttons -->
        <div class="w-full flex flex-col items-center mt-8">
            <!-- Single QR Code Container -->
            <div id="qrcode-container-single" class="w-full max-w-xs mb-6 p-4 bg-gray-100 rounded-xl shadow-inner flex justify-center items-center aspect-square hidden">
                <p class="text-gray-400">Your QR code will appear here.</p>
            </div>
            <button id="download-btn"
                    class="px-6 py-3 bg-green-500 text-white font-semibold rounded-xl hover:bg-green-600 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 hidden mb-4">
                Download QR Code
            </button>

            <!-- Multiple QR Codes Container -->
            <div id="qrcode-container-multi" class="w-full grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 hidden">
                <!-- QR codes for multiple URLs will be appended here -->
            </div>
            <button id="download-pdf-btn"
                    class="px-6 py-3 bg-red-500 text-white font-semibold rounded-xl hover:bg-red-600 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 hidden mt-4">
                Download All as PDF
            </button>
        </div>
    </div>

    <!-- QR code generation library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <!-- jsPDF library for generating PDF files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <script>
        window.onload = function() {
            // Get references to all necessary DOM elements
            const singleModeBtn = document.getElementById('single-mode-btn');
            const multiModeBtn = document.getElementById('multi-mode-btn');
            const singleUrlSection = document.getElementById('single-url-section');
            const multiUrlSection = document.getElementById('multi-url-section');
            const urlInput = document.getElementById('url-input');
            const multiUrlInputsContainer = document.getElementById('multi-url-inputs-container');
            const addUrlBtn = document.getElementById('add-url-btn');
            const generateBtn = document.getElementById('generate-btn');
            const generateMultiBtn = document.getElementById('generate-multi-btn');
            const qrCodeContainerSingle = document.getElementById('qrcode-container-single');
            const qrCodeContainerMulti = document.getElementById('qrcode-container-multi');
            const downloadBtn = document.getElementById('download-btn');
            const downloadPdfBtn = document.getElementById('download-pdf-btn');

            let qrCodeInstance = null; // Variable for single QR code instance

            // Function to add a new URL input field
            function addUrlInput() {
                const inputGroup = document.createElement('div');
                inputGroup.className = 'input-group';
                
                const input = document.createElement('input');
                input.type = 'url';
                input.placeholder = 'Enter URL here';
                input.className = 'p-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-indigo-500 transition-colors duration-200 mr-2';
                
                const removeBtn = document.createElement('button');
                removeBtn.textContent = 'Remove';
                removeBtn.className = 'px-4 py-2 bg-gray-200 text-gray-700 font-semibold rounded-xl hover:bg-gray-300 transition-colors duration-200 focus:outline-none';
                removeBtn.onclick = () => {
                    inputGroup.remove();
                };

                inputGroup.appendChild(input);
                inputGroup.appendChild(removeBtn);
                multiUrlInputsContainer.appendChild(inputGroup);
            }

            // Function to switch between modes
            function switchMode(mode) {
                if (mode === 'single') {
                    singleUrlSection.classList.remove('hidden');
                    multiUrlSection.classList.add('hidden');
                    singleModeBtn.classList.add('bg-indigo-600', 'text-white');
                    singleModeBtn.classList.remove('bg-gray-200', 'text-gray-700');
                    multiModeBtn.classList.remove('bg-indigo-600', 'text-white');
                    multiModeBtn.classList.add('bg-gray-200', 'text-gray-700');
                    qrCodeContainerMulti.classList.add('hidden');
                    downloadPdfBtn.classList.add('hidden');
                } else {
                    singleUrlSection.classList.add('hidden');
                    multiUrlSection.classList.remove('hidden');
                    multiModeBtn.classList.add('bg-indigo-600', 'text-white');
                    multiModeBtn.classList.remove('bg-gray-200', 'text-gray-700');
                    singleModeBtn.classList.remove('bg-indigo-600', 'text-white');
                    singleModeBtn.classList.add('bg-gray-200', 'text-gray-700');
                    qrCodeContainerSingle.classList.add('hidden');
                    downloadBtn.classList.add('hidden');
                    // Ensure at least one input field is present
                    if (multiUrlInputsContainer.children.length === 0) {
                        addUrlInput();
                    }
                }
            }

            // Event listeners for mode buttons
            singleModeBtn.addEventListener('click', () => switchMode('single'));
            multiModeBtn.addEventListener('click', () => switchMode('multiple'));
            addUrlBtn.addEventListener('click', addUrlInput);

            // Function to show a message in the single QR section
            function showMessage(message, color = 'text-gray-400') {
                qrCodeContainerSingle.innerHTML = `<p class="${color}">${message}</p>`;
                qrCodeContainerSingle.classList.remove('hidden');
                downloadBtn.classList.add('hidden');
            }

            // Event listener for the single generate button
            generateBtn.addEventListener('click', () => {
                const url = urlInput.value.trim();

                if (!url) {
                    showMessage('Please enter a valid URL.', 'text-red-500');
                    return;
                }

                if (qrCodeInstance) {
                    qrCodeInstance.clear();
                }
                
                qrCodeContainerSingle.innerHTML = '';
                qrCodeContainerSingle.classList.remove('hidden');

                qrCodeInstance = new QRCode(qrCodeContainerSingle, {
                    text: url,
                    width: 256,
                    height: 256,
                    colorDark: '#000000',
                    colorLight: '#ffffff',
                    correctLevel: QRCode.CorrectLevel.H
                });

                setTimeout(() => {
                    const canvas = qrCodeContainerSingle.querySelector('canvas');
                    if (canvas) {
                        downloadBtn.classList.remove('hidden');
                    } else {
                        downloadBtn.classList.add('hidden');
                    }
                }, 500);
            });

            // Event listener for the single download button
            downloadBtn.addEventListener('click', () => {
                const canvas = qrCodeContainerSingle.querySelector('canvas');
                if (canvas) {
                    const link = document.createElement('a');
                    link.download = 'qrcode.png';
                    link.href = canvas.toDataURL('image/png');
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                } else {
                    showMessage('Could not find the QR code image to download.', 'text-red-500');
                }
            });

            // Event listener for the multiple generate button
            generateMultiBtn.addEventListener('click', () => {
                const urlInputs = multiUrlInputsContainer.querySelectorAll('input');
                const urls = Array.from(urlInputs).map(input => input.value.trim()).filter(url => url !== '');
                qrCodeContainerMulti.innerHTML = '';
                
                if (urls.length === 0) {
                    qrCodeContainerMulti.classList.add('hidden');
                    downloadPdfBtn.classList.add('hidden');
                    return;
                }

                qrCodeContainerMulti.classList.remove('hidden');

                urls.forEach(url => {
                    const qrItem = document.createElement('div');
                    qrItem.className = 'qr-item';

                    const qrCanvasDiv = document.createElement('div');
                    new QRCode(qrCanvasDiv, {
                        text: url,
                        width: 150,
                        height: 150,
                        colorDark: '#000000',
                        colorLight: '#ffffff',
                        correctLevel: QRCode.CorrectLevel.H
                    });

                    qrItem.appendChild(qrCanvasDiv);
                    qrCodeContainerMulti.appendChild(qrItem);
                });

                downloadPdfBtn.classList.remove('hidden');
            });

            // Event listener for the PDF download button
            downloadPdfBtn.addEventListener('click', () => {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF('p', 'mm', 'a4'); // Portrait, millimeters, A4 size
                const qrCanvases = qrCodeContainerMulti.querySelectorAll('canvas');

                if (qrCanvases.length === 0) {
                    return;
                }

                const pageHeight = doc.internal.pageSize.getHeight();
                const pageWidth = doc.internal.pageSize.getWidth();
                const qrSize = 80; // mm

                // Calculate the vertical space to ensure equal spacing.
                const totalVerticalSpace = pageHeight - (2 * qrSize);
                const verticalSpacing = totalVerticalSpace / 3;

                qrCanvases.forEach((canvas, index) => {
                    const qrNumber = index + 1;

                    // Add a new page for every two QR codes.
                    if (qrNumber > 1 && (qrNumber - 1) % 2 === 0) {
                        doc.addPage();
                    }

                    // Calculate position for QR code
                    const isFirstOnPage = (qrNumber - 1) % 2 === 0;
                    let y = isFirstOnPage ? verticalSpacing : (2 * verticalSpacing) + qrSize;
                    let x = (pageWidth - qrSize) / 2; // Center the QR code

                    const imageData = canvas.toDataURL('image/png');
                    doc.addImage(imageData, 'PNG', x, y, qrSize, qrSize);
                });

                doc.save('qr-codes.pdf');
            });

            // Set the initial mode to 'single'
            switchMode('single');
        };
    </script>
</body>
</html>
